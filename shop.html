<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>CatClient | Shop</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">

<style>
body {
  font-family: Inter, sans-serif;
  background: #0f111a;
  color: white;
  padding: 80px 10%;
}
.top-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.btn-login {
  padding: 12px 28px;
  border-radius: 14px;
  font-weight: 700;
  background: orange;
  border: none;
  cursor: pointer;
}
.shop-grid {
  margin-top: 50px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 30px;
}
.item {
  background: #1a1d29;
  padding: 20px;
  border-radius: 20px;
}
.btn {
  background: orange;
  padding: 14px 20px;
  border-radius: 14px;
  border: none;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="top-bar">
  <div>
    <button id="loginBtn" class="btn-login">Login mit Microsoft</button>
    <span id="userInfo"></span>
  </div>
  <a href="index.html" class="btn">‚Üê Zur√ºck</a>
</div>

<h1>üé® Cosmetics Shop</h1>

<div class="shop-grid">
  <div class="item">
    <h2>Orange Cat Cape</h2>
    <p>Preis: 3,99‚Ç¨</p>
    <button class="btn buy-btn" data-name="Orange Cat Cape" data-price="3.99">Kaufen</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, OAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyChdNqyb8KIkHTe4TCJkQOJ8V2t2u6oJTo",
  authDomain: "catclient-app.firebaseapp.com",
  projectId: "catclient-app",
  storageBucket: "catclient-app.firebasestorage.app",
  messagingSenderId: "421552104568",
  appId: "1:421552104568:web:def5045766ba863f90f98d"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new OAuthProvider("microsoft.com");

const loginBtn = document.getElementById("loginBtn");
const userInfo = document.getElementById("userInfo");

loginBtn.onclick = () => signInWithPopup(auth, provider);

onAuthStateChanged(auth, user => {
  if (user) {
    userInfo.textContent = "Eingeloggt als " + user.displayName;
    loginBtn.style.display = "none";
  }
});

document.querySelectorAll(".buy-btn").forEach(btn => {
  btn.onclick = async () => {
    if (!auth.currentUser) return alert("Bitte einloggen!");

    await addDoc(collection(db, "purchases"), {
      item: btn.dataset.name,
      price: btn.dataset.price,
      user: auth.currentUser.uid,
      timestamp: serverTimestamp()
    });

    alert("Kauf gespeichert (Stripe kommt danach)");
  };
});
</script>

</body>
</html>
