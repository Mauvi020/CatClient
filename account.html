<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CatClient | Account</title>
<style>
body{background:#0f111a;color:white;font-family:Inter,sans-serif;padding:50px;}
h1{margin-bottom:30px;text-align:center;}
.btn{background:#ff8800;color:black;padding:10px 20px;border-radius:12px;font-weight:700;margin:10px;cursor:pointer;}
.cosmetic{background:#1a1d29;padding:20px;border-radius:18px;margin-bottom:15px;}
</style>
</head>
<body>

<h1>ðŸ‘¤ Mein Account</h1>
<div id="user-info"></div>
<div id="cosmetics"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyChdNqyb8KIkHTe4TCJkQOJ8V2t2u6oJTo",
  authDomain: "catclient-app.firebaseapp.com",
  projectId: "catclient-app",
  storageBucket: "catclient-app.appspot.com",
  messagingSenderId: "421552104568",
  appId: "1:421552104568:web:def5045766ba863f90f98d",
  measurementId: "G-6Z48QJMQNJ"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth, async user=>{
    const infoDiv = document.getElementById("user-info");
    const cosmeticsDiv = document.getElementById("cosmetics");

    if(!user){
        infoDiv.innerHTML="<p>Bitte einloggen!</p>";
        cosmeticsDiv.innerHTML="";
        return;
    }

    infoDiv.innerHTML=`<p>Eingeloggt als: ${user.displayName} <button class="btn" id="logout-btn">Logout</button></p>`;
    document.getElementById("logout-btn").addEventListener("click", ()=>signOut(auth));

    const userDoc = await getDoc(doc(db,"users",user.uid));
    const owned = userDoc.exists() && userDoc.data().ownedCosmetics ? userDoc.data().ownedCosmetics : [];

    cosmeticsDiv.innerHTML="<h3>Gekaufte Cosmetics:</h3>";
    if(owned.length===0) cosmeticsDiv.innerHTML+="<p>Keine Cosmetics gekauft</p>";
    else owned.forEach(cosmetic=>{
        const div = document.createElement("div");
        div.className="cosmetic";
        div.textContent=cosmetic;
        cosmeticsDiv.appendChild(div);
    });
});
</script>

</body>
</html>
