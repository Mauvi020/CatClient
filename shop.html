<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>CatClient | Shop</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">

<style>
:root {
    --primary: #ff8800;
    --bg: #0f111a;
    --card-bg: #1a1d29;
    --text: #ffffff;
    --text-dim: #e0e0e0;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg, #0f111a, #181a28);
    color: var(--text);
    padding: 80px 10%;
}

.top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 40px;
}

.user-info {
    font-size: 0.9rem;
    color: var(--text-dim);
}

.btn-login {
    padding: 12px 28px;
    border-radius: 14px;
    font-weight: 700;
    background: linear-gradient(135deg, #ff8800, #ffaa33);
    color: #000;
    border: none;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}

.btn-login:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(255,136,0,0.5);
}

h1 {
    text-align: center;
    font-size: 2.8rem;
    margin-bottom: 60px;
    background: linear-gradient(90deg, #ff8800, #ffaa33);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

/* Shop Grid */
.shop-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 30px;
}

/* Item Card */
.item {
    background: var(--card-bg);
    border-radius: 25px;
    overflow: hidden;
    box-shadow: 0 12px 35px rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
    transition: transform 0.2s, box-shadow 0.2s;
}

.item:hover {
    transform: translateY(-5px);
    box-shadow: 0 18px 50px rgba(255,136,0,0.4);
}

.item img {
    width: 100%;
    height: 220px;
    object-fit: cover;
}

.item-content {
    padding: 25px 30px;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.item h2 {
    font-size: 1.8rem;
    margin-bottom: 10px;
    background: linear-gradient(90deg, #ff8800, #ffaa33);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.item p {
    color: var(--text-dim);
    margin-bottom: 15px;
    font-weight: 500;
}

.btn {
    background: linear-gradient(135deg, #ff8800, #ffaa33);
    color: #000;
    padding: 14px 28px;
    border-radius: 16px;
    border: none;
    font-weight: 700;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    text-decoration: none;
    text-align: center;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(255,136,0,0.5);
}

.back-btn {
    display: inline-block;
    margin-top: 50px;
    background: linear-gradient(135deg, #ffffff, #ffcc88);
    color: #000;
    padding: 14px 30px;
    border-radius: 16px;
    text-decoration: none;
    font-weight: 700;
    transition: transform 0.2s, box-shadow 0.2s;
}

.back-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(255,136,0,0.4);
}
</style>
</head>

<body>

<div class="top-bar">
    <div>
        <button id="loginBtn" class="btn-login">Login mit Google</button>
        <span id="userInfo" class="user-info"></span>
    </div>
    <a href="index.html" class="back-btn">‚Üê Zur√ºck</a>
</div>

<h1>üé® Cosmetics Shop</h1>

<div class="shop-grid">

    <div class="item">
        <img src="orange_cat_cape.png" alt="Orange Cat Cape">
        <div class="item-content">
            <div>
                <h2>Orange Cat Cape</h2>
                <p>Legend√§res Katzen-Cape</p>
                <p>Preis: 3,99‚Ç¨</p>
            </div>
            <button class="btn buy-btn"
                data-id="orange_cat_cape"
                data-name="Orange Cat Cape"
                data-price="3.99">
                Kaufen
            </button>
        </div>
    </div>

    <div class="item">
        <img src="blue_cat_hat.png" alt="Blauer Katzenhut">
        <div class="item-content">
            <div>
                <h2>Blauer Katzenhut</h2>
                <p>Stylischer Kopfschmuck f√ºr deinen CatClient</p>
                <p>Preis: 2,99‚Ç¨</p>
            </div>
            <button class="btn buy-btn"
                data-id="blue_cat_hat"
                data-name="Blauer Katzenhut"
                data-price="2.99">
                Kaufen
            </button>
        </div>
    </div>

</div>

<!-- Firebase + Shop Logic -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAnalytics, logEvent } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyChdNqyb8KIkHTe4TCJkQOJ8V2t2u6oJTo",
  authDomain: "catclient-app.firebaseapp.com",
  projectId: "catclient-app",
  storageBucket: "catclient-app.firebasestorage.app",
  messagingSenderId: "421552104568",
  appId: "1:421552104568:web:def5045766ba863f90f98d",
  measurementId: "G-6Z48QJMQNJ"
};

const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

const loginBtn = document.getElementById("loginBtn");
const userInfo = document.getElementById("userInfo");
const buyButtons = document.querySelectorAll(".buy-btn");

loginBtn.addEventListener("click", async () => {
  try {
    await signInWithPopup(auth, provider);
  } catch (e) {
    alert("Login fehlgeschlagen: " + e.message);
  }
});

onAuthStateChanged(auth, (user) => {
  if (user) {
    userInfo.textContent = "Eingeloggt als " + user.displayName;
    loginBtn.style.display = "none";
  } else {
    userInfo.textContent = "";
    loginBtn.style.display = "inline-block";
  }
});

buyButtons.forEach(btn => {
  btn.addEventListener("click", async () => {
    if (!auth.currentUser) {
      alert("Bitte logge dich zuerst ein.");
      return;
    }

    const itemId = btn.dataset.id;
    const itemName = btn.dataset.name;
    const itemPrice = btn.dataset.price;

    try {
      await addDoc(collection(db, "purchases"), {
        itemId,
        itemName,
        price: itemPrice,
        user: auth.currentUser.uid,
        timestamp: serverTimestamp()
      });

      logEvent(analytics, "purchase", {
        item_id: itemId,
        item_name: itemName,
        price: itemPrice
      });

      alert("Kauf erfolgreich! üéâ");
    } catch (e) {
      console.error("Kauf Fehler:", e);
      alert("Fehler beim Kauf.");
    }
  });
});
</script>

</body>
</html>
